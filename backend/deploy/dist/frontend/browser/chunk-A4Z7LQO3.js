import{a as U,b as q,c as z,d as G,e as J}from"./chunk-H7DJB634.js";import{a as H}from"./chunk-HXMLE2GD.js";import"./chunk-37K4UUCH.js";import{a as N}from"./chunk-GXOHLRUE.js";import{a as O,h as j}from"./chunk-G6ZGHL4Y.js";import{Ab as I,Db as b,Eb as l,Mb as d,Ob as g,Pb as P,Qb as V,Tb as B,Ub as R,Va as u,d as s,e as _,ea as p,ec as A,f as v,fb as M,ia as y,ja as $,lb as S,ma as F,rb as E,sa as x,sb as k,ta as C,tb as T,ub as D,vb as m,wb as a,xb as f,ya as L}from"./chunk-GRUJPSUA.js";var K=(()=>{let e=class e{transform(n){return new Date(n).toLocaleDateString()}};e.\u0275fac=function(o){return new(o||e)},e.\u0275pipe=F({name:"date",type:e,pure:!0,standalone:!0});let t=e;return t})();function Y(t,e){if(t&1){let i=I();m(0,"mat-action-list")(1,"button",1),b("click",function(){x(i);let o=l().$implicit,h=l();return C(h.edit_review(o._id))}),d(2,"Edit"),a(),m(3,"button",1),b("click",function(){x(i);let o=l().$implicit,h=l();return C(h.delete_review(o._id))}),d(4,"Delete"),a()()}}function Z(t,e){if(t&1&&(m(0,"mat-list")(1,"mat-list-item"),d(2),a(),f(3,"mat-divider"),m(4,"mat-list-item"),d(5),B(6,"date"),a(),f(7,"mat-divider"),S(8,Y,5,0,"mat-action-list"),f(9,"mat-divider")(10,"mat-divider"),a()),t&2){let i=e.$implicit,n=l();u(2),g(" By: ",i.by.fullname," "),u(3),g(" Date: ",R(6,3,i.date)," "),u(3),E(8,i.by.user_id===n.auth_service.$state()._id?8:-1)}}function tt(t,e){t&1&&(m(0,"mat-list")(1,"mat-list-item"),d(2,"No reviews available"),a()())}var Q=(()=>{var e,i,n;let o=class o{constructor(){_(this,e,void 0);_(this,i,void 0);_(this,n,void 0);this.medication_id=L(""),this.$reviews=M([]),v(this,e,p(O)),v(this,i,p(N)),this.auth_service=p(H),v(this,n,p(j)),A(()=>{s(this,e).get(`http://localhost:3000/medications/${this.medication_id()}/reviews`).subscribe(r=>{r.success&&(this.$reviews.set(r.data),console.log(this.$reviews()),s(this,i).success(this.$reviews()?.[0].by.fullname))})})}edit_review(r){s(this,n).navigate(["medications","details",this.medication_id(),"reviews","update-review",r])}delete_review(r){s(this,e).delete(`http://localhost:3000/medications/${this.medication_id()}/reviews/${r}`).subscribe(c=>{this.$reviews.update(w=>w.filter(W=>W._id!==r)),s(this,i).success("Review deleted successfully")},c=>{s(this,i).error("Failed to delete review")})}};e=new WeakMap,i=new WeakMap,n=new WeakMap,o.\u0275fac=function(c){return new(c||o)},o.\u0275cmp=$({type:o,selectors:[["app-list"]],inputs:{medication_id:[y.SignalBased,"medication_id"]},standalone:!0,features:[P([]),V],decls:4,vars:1,consts:[[1,"review-container"],["mat-button","",3,"click"]],template:function(c,w){c&1&&(m(0,"div",0),T(1,Z,11,5,"mat-list",null,k,!1,tt,3,0,"mat-list"),a()),c&2&&(u(),D(w.$reviews()))},dependencies:[J,z,q,G,U,K],styles:[".review-container[_ngcontent-%COMP%]{margin-top:50px;min-width:400px;background-color:#e5e5e3}button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:14px 20px;margin:8px 0;border:none;cursor:pointer}"]});let t=o;return t})();var vt=[{path:"",component:Q,pathMatch:"full"},{path:"add-review",loadComponent:()=>import("./chunk-JVWA7XUC.js").then(t=>t.AddReviewComponent)},{path:"update-review/:review_id",loadComponent:()=>import("./chunk-OCKJJYQV.js").then(t=>t.UpdateComponent)}];export{vt as reviewsRoutes};
